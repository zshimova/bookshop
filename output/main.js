(()=>{"use strict";(()=>{const e=()=>{const e=document.getElementById("popup-cart"),a=document.getElementById("cart-items");a.innerHTML="";const l=JSON.parse(localStorage.getItem("cart"))||[];if(0===l.length){const e=document.createElement("div");e.className="empty-cart-message",e.innerText="В корзине ничего нет",a.appendChild(e)}else l.forEach(((e,l)=>{const n=document.createElement("div");n.className="cart-item",n.innerHTML=`<span>${e.title}</span>`;const o=document.createElement("button");o.innerText="Удалить",o.addEventListener("click",(()=>t(l,e.id))),n.appendChild(o),a.appendChild(n)}));e.style.display="flex"},t=(t,l)=>{let n=JSON.parse(localStorage.getItem("cart"))||[];n.splice(t,1),localStorage.setItem("cart",JSON.stringify(n)),e();const o=document.getElementById(l).querySelector(".btn");o&&(o.innerHTML="BUY NOW",o.classList.remove("added")),a()},a=()=>{const e=document.querySelector(".header__icons-bag");let t=JSON.parse(localStorage.getItem("cart"))||[],a=`<div class="items-number">${t.length}</div>`;e.innerHTML=t.length>0?a:""};document.getElementById("close-popup").addEventListener("click",(()=>{document.getElementById("popup-cart").style.display="none"})),document.querySelector(".header__icons-bag").addEventListener("click",e)})(),(()=>{let e=[{url:"./src/img/banners/banner.svg",title:"Black Friday Sale banner"},{url:"./src/img/banners/banner-2.svg",title:"Top 10 Books banner"},{url:"./src/img/banners/banner-3.svg",title:"Cozy Books banner"}];document.addEventListener("DOMContentLoaded",(()=>{!function(e,t){if(!e||!e.length)return;t=t||{dots:!1,titles:!1,autoplay:!1,autoplayInterval:5e3};const a=document.querySelector(".slider"),l=a.querySelector(".slider__images");function n(a){if(l.querySelector(".active").classList.remove("active"),l.querySelector(`.n${a}`).classList.add("active"),t.titles){let t=l.querySelector(".slider__images-title");e[a].title?(t.innerText=e[a].title,t.style.display="block"):t.style.display="none"}if(t.dots){let e=document.querySelector(".slider__dots");e.querySelector(".active").classList.remove("active"),e.querySelector(`.n${a}`).classList.add("active")}}e.forEach(((e,t)=>{let a=document.createElement("div");a.className=`image n${t} ${t?"":"active"}`,a.dataset.index=t,a.style.backgroundImage=`url(${e.url})`,l.appendChild(a)})),t.dots&&function(){let t=document.createElement("div");t.className="slider__dots",e.forEach(((e,a)=>{let l=document.createElement("div");l.className=`slider__dots-item n${a} ${a?"":"active"}`,l.dataset.index=a,l.addEventListener("click",(function(){n(this.dataset.index)})),t.appendChild(l)})),a.appendChild(t)}(),t.titles&&function(){let t=`<div class="slider__images-title">${e[0].title}</div>`;l.innerHTML+=t}(),t.autoplay&&setInterval((()=>{let t=+l.querySelector(".active").dataset.index;n(t===e.length-1?0:t+1)}),t.autoplayInterval)}(e,{dots:!0,titles:!1,autoplay:!0,autoplayInterval:5e3})}))})(),(()=>{let e=document.querySelector(".book-gallery__category-item").getAttribute("data-category"),t=0;const a=async()=>{let a=await fetch(`https://www.googleapis.com/books/v1/volumes?q=${e}&key=AIzaSyC4NQMdGh19j2ElPgpWDLaXsdb7k_C_rLQ&printType=books&startIndex=${t}&maxResults=6&langRestrict=en`).then((e=>e.json())).then((e=>e.items)).catch((e=>console.log(e)));a&&(t+=6,a.forEach((e=>{let t=e.volumeInfo.imageLinks?.thumbnail??"./src/img/icons/logo.svg",a=e.volumeInfo.authors?.join(", ")??"Unknown Author",l=e.volumeInfo.title,n=e.volumeInfo.description??"No description",o=e.volumeInfo.ratingsCount?`${e.volumeInfo.ratingsCount} reviews`:"",s="FOR_SALE"===e.saleInfo.saleability?`${e.saleInfo.retailPrice.amount} ${e.saleInfo.retailPrice.currencyCode}`:"Without price",r=`\n                <div class="book-gallery__book" id="${e.id}">\n                    <img src="${t}" alt="${e.title}" class="book-gallery__book-img">\n                    <div class="book-gallery__info">\n                        <div class="book-gallery__first-block">\n                            <h3 class="author">${a}</h3>\n                            <h2 class="title">${l}</h2>\n                            <div class="rating">\n                                <div class="review-stars">\n                                    <div class="count">${o}</div>\n                                    <div class="stars">\n                                        ${'<img src="./src/img/icons/gray-star.svg" class="review-star">'.repeat(5)}\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        <div class="book-gallery__second-block">\n                            <p class="description">${n}</p>\n                            <span class="price">${s}</span>\n                            <button class="btn" id="${e.id}">BUY NOW</button>\n                        </div>\n                    </div>\n                </div>`;document.querySelector(".book-gallery__books").innerHTML+=r;let i=Math.floor(e.volumeInfo.averageRating||0),c=document.getElementById(e.id).querySelectorAll(".review-star");for(let e=0;e<i;e++)c[e].src="./src/img/icons/gold-star.svg"})),l())},l=()=>{const e=Array.from(document.querySelectorAll(".btn")),t=document.querySelector(".header__icons-bag");let a=()=>{let e=JSON.parse(localStorage.getItem("cart"))||[],a=`<div class="items-number">${e.length}</div>`;t.innerHTML=e.length>0?a:""};e.forEach((e=>{let t=e.id,l={id:t,title:e.closest(".book-gallery__book").querySelector(".title").textContent,author:e.closest(".book-gallery__book").querySelector(".author").textContent,price:e.closest(".book-gallery__second-block").querySelector(".price").textContent};(JSON.parse(localStorage.getItem("cart"))||[]).some((e=>e.id===t))&&(e.classList.add("added"),e.innerHTML="IN THE CART"),e.addEventListener("click",(()=>{e.classList.contains("added")?(o(t),e.innerHTML="BUY NOW",e.classList.remove("added")):(n(l),e.innerHTML="IN THE CART",e.classList.add("added")),a()}))})),a()},n=e=>{let t=JSON.parse(localStorage.getItem("cart"))||[];t.some((t=>t.id===e.id))||(t.push(e),localStorage.setItem("cart",JSON.stringify(t)))},o=e=>{let t=JSON.parse(localStorage.getItem("cart"))||[];t=t.filter((t=>t.id!==e)),localStorage.setItem("cart",JSON.stringify(t))};a(),document.addEventListener("click",(l=>{l.target.classList.contains("book-gallery__category-item")&&(document.querySelector(".book-gallery__category-item.active")?.classList.remove("active"),l.target.classList.add("active"),document.querySelector(".book-gallery__books").innerHTML="",e=l.target.innerText,t=0,a()),l.target.classList.contains("load-more")&&a()}))})()})();